<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Apollo C++ Client: Apollo C++ Client</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Apollo C++ Client
   </div>
   <div id="projectbrief">C++ client for Apollo Configuration Center</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md__r_e_a_d_m_e.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Apollo C++ Client </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
Overview</h1>
<p>A C++ Client library for the <a href="https://github.com/apolloconfig/apollo">Apollo</a> configuration center.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
Features</h2>
<ul>
<li>Support for Apollo long polling and notification mechanisms</li>
<li>Support for Apollo configuration updates</li>
<li>Support for Apollo gray release by label</li>
<li>Thread-safe access to configuration values</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
TODO Features</h2>
<ul>
<li>Implement HTTPS support.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
Prerequisites</h2>
<ul>
<li>C++14 compatible compiler</li>
<li>CMake 3.11 or higher</li>
<li>Boost 1.84 or higher, using the following Boost libraries:<ul>
<li>boost::asio for networking</li>
<li>boost::url for URL parsing</li>
</ul>
</li>
<li>nlohmann_json 3.11.2 or higher</li>
<li>doctest 2.4 or higher (for testing, optional)</li>
<li>Doxygen 1.14.0 or higher (for documentation generation, optional)</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
Building</h2>
<div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line"> </div>
<div class="line"># This flag generates a `compile_commands.json` file for integration with tools like clangd.</div>
<div class="line">cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=ON ..</div>
<div class="line"> </div>
<div class="line"># Use `make -jN` to speed up the build process, where `N` is the number of parallel jobs.</div>
<div class="line">make -j4</div>
<div class="line"> </div>
<div class="line"># Now build the docs target, which generates the documentation.</div>
<div class="line"># This requires Doxygen version 1.14.0 to be installed on your system.</div>
<div class="line"># If you don&#39;t have Doxygen installed, you can skip this step.</div>
<div class="line"># ref: https://github.com/doxygen/doxygen</div>
<div class="line"># docs output will be built in the build/docs directory</div>
<div class="line">cmake --build . --target docs</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
Usage</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="apollo__client_8h.html">apollo/apollo_client.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> notification_callback_ptr = std::make_shared&lt;apollo::client::NotificationCallback&gt;(</div>
<div class="line">    [](<span class="keyword">const</span> <a class="code hl_typedef" href="apollo__types_8h.html#a55454c6c92726d53ce0cdc7edf0f3501">apollo::client::NamespaceType</a>&amp; n,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="apollo__types_8h.html#ad68bbd8ab75d3434eb689eec7620e616">apollo::client::Configures</a>&amp; olds,</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_typedef" href="apollo__types_8h.html#ad68bbd8ab75d3434eb689eec7620e616">apollo::client::Configures</a>&amp; news,</div>
<div class="line">        <a class="code hl_typedef" href="apollo__types_8h.html#a56042b545bfd4c8559c3e6c8d74bc401">apollo::client::Changes</a>&amp;&amp; changes)</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;configuration changed for namespace: &quot;</span> &lt;&lt; n &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> ns : changes)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (ns.change_type_)</div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="apollo__types_8h.html#a7b2b05252fe09b213f98a7248575ed0caf29ddbfb905eb2593fdcdfb243f9af85">apollo::client::ChangeType::Added</a>:</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;namespace:&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; Added: &quot;</span> &lt;&lt; ns.key_ &lt;&lt; <span class="stringliteral">&quot; = &quot;</span></div>
<div class="line">                                &lt;&lt; ns.value_ &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="apollo__types_8h.html#a7b2b05252fe09b213f98a7248575ed0caff0a3b7f3daef040faf89a88fdac01b7">apollo::client::ChangeType::Updated</a>:</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;namespace:&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; Modified: &quot;</span> &lt;&lt; ns.key_ &lt;&lt; <span class="stringliteral">&quot; = &quot;</span></div>
<div class="line">                                &lt;&lt; ns.value_ &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="apollo__types_8h.html#a7b2b05252fe09b213f98a7248575ed0ca5fe6005bf6e415c950c011fb65f12b8f">apollo::client::ChangeType::Deleted</a>:</div>
<div class="line">                    std::cout &lt;&lt; <span class="stringliteral">&quot;namespace:&quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot; Deleted: &quot;</span> &lt;&lt; ns.key_ &lt;&lt; std::endl;</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">apollo::client::ClientPtr client;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="structapollo_1_1client_1_1_opts.html">apollo::client::Opts</a> opts;</div>
<div class="line">opts.<a class="code hl_variable" href="structapollo_1_1client_1_1_opts.html#ab66463ed5bce41fd676467ec00289eaf">cluster_name_</a> = <span class="stringliteral">&quot;cluster&quot;</span>;                    <span class="comment">// Apollo cluster name</span></div>
<div class="line">opts.<a class="code hl_variable" href="structapollo_1_1client_1_1_opts.html#a488e477e0eb10f69f67651f46c59fd16">namespaces_</a> = {<span class="stringliteral">&quot;config1&quot;</span>, <span class="stringliteral">&quot;config2&quot;</span>};         <span class="comment">// Apollo namespaces to subscribe to</span></div>
<div class="line">std::string app_id = <span class="stringliteral">&quot;test&quot;</span>;                       <span class="comment">// Apollo application ID</span></div>
<div class="line">std::string apollo_url = <span class="stringliteral">&quot;http://localhost:8080&quot;</span>;  <span class="comment">// Apollo server URL</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Create an Apollo client instance with the specified options.</span></div>
<div class="line">    <span class="comment">// The method will connect to the Apollo server and load configurations for initialization when created.</span></div>
<div class="line">    <span class="comment">// Throws std::runtime_error If initialization fails (e.g., invalid URL or app_id, network issues).</span></div>
<div class="line">    <span class="comment">// client should be hold by caller, otherwise it will be destroyed immediately.</span></div>
<div class="line">    client = <a class="code hl_function" href="apollo__client_8h.html#ab78f24bd3e3930599235929b24663c8a">apollo::client::makeApolloClient</a>(apollo_url, app_id, std::move(opts));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set the notification callback to handle configuration changes.</span></div>
<div class="line">    client-&gt;setNotificationsListener(notification_callback_ptr);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Starts a background thread that periodically polls the Apollo server for configuration updates.</span></div>
<div class="line">    <span class="comment">// This method is non-blocking; it starts the polling thread and returns immediately.</span></div>
<div class="line">    client-&gt;startLongPolling();</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error initializing Apollo client: &quot;</span> + std::string(e.what()));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// now the client is running and listening for configuration changes,you can use it anywhere in your application,and client is thread-safe.</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Get a configuration from the specified namespace.</span></div>
<div class="line"><span class="comment">// Returns an empty map if the namespace is not in the configured namespaces list</span></div>
<div class="line"><span class="comment">// If long polling has not been started, this will return only the initial configuration loaded at ApolloClient creation.</span></div>
<div class="line"><span class="comment">// no exception is thrown.</span></div>
<div class="line"><span class="keyword">auto</span> configures = client-&gt;getConfigures(<span class="stringliteral">&quot;config1&quot;</span>);</div>
<div class="line">...</div>
<div class="line">...</div>
<div class="line">...</div>
<div class="line">client-&gt;stopLongPolling(); <span class="comment">// Stop the long polling thread.</span></div>
<div class="ttc" id="aapollo__client_8h_html"><div class="ttname"><a href="apollo__client_8h.html">apollo_client.h</a></div><div class="ttdoc">Apollo Configuration Center Client Library.</div></div>
<div class="ttc" id="aapollo__client_8h_html_ab78f24bd3e3930599235929b24663c8a"><div class="ttname"><a href="apollo__client_8h.html#ab78f24bd3e3930599235929b24663c8a">apollo::client::makeApolloClient</a></div><div class="ttdeci">ClientPtr makeApolloClient(const std::string &amp;apollo_url, const std::string &amp;app_id, Opts &amp;&amp;opts=Opts(), LoggerPtr logger=nullptr)</div><div class="ttdoc">Creates a new Apollo client instance.</div></div>
<div class="ttc" id="aapollo__types_8h_html_a55454c6c92726d53ce0cdc7edf0f3501"><div class="ttname"><a href="apollo__types_8h.html#a55454c6c92726d53ce0cdc7edf0f3501">apollo::client::NamespaceType</a></div><div class="ttdeci">std::string NamespaceType</div><div class="ttdoc">Type alias for namespace identifiers.</div><div class="ttdef"><b>Definition</b> apollo_types.h:22</div></div>
<div class="ttc" id="aapollo__types_8h_html_a56042b545bfd4c8559c3e6c8d74bc401"><div class="ttname"><a href="apollo__types_8h.html#a56042b545bfd4c8559c3e6c8d74bc401">apollo::client::Changes</a></div><div class="ttdeci">std::vector&lt; Change &gt; Changes</div><div class="ttdoc">List of configuration changes.</div><div class="ttdef"><b>Definition</b> apollo_types.h:62</div></div>
<div class="ttc" id="aapollo__types_8h_html_a7b2b05252fe09b213f98a7248575ed0ca5fe6005bf6e415c950c011fb65f12b8f"><div class="ttname"><a href="apollo__types_8h.html#a7b2b05252fe09b213f98a7248575ed0ca5fe6005bf6e415c950c011fb65f12b8f">apollo::client::ChangeType::Deleted</a></div><div class="ttdeci">@ Deleted</div><div class="ttdef"><b>Definition</b> apollo_types.h:32</div></div>
<div class="ttc" id="aapollo__types_8h_html_a7b2b05252fe09b213f98a7248575ed0caf29ddbfb905eb2593fdcdfb243f9af85"><div class="ttname"><a href="apollo__types_8h.html#a7b2b05252fe09b213f98a7248575ed0caf29ddbfb905eb2593fdcdfb243f9af85">apollo::client::ChangeType::Added</a></div><div class="ttdeci">@ Added</div><div class="ttdef"><b>Definition</b> apollo_types.h:30</div></div>
<div class="ttc" id="aapollo__types_8h_html_a7b2b05252fe09b213f98a7248575ed0caff0a3b7f3daef040faf89a88fdac01b7"><div class="ttname"><a href="apollo__types_8h.html#a7b2b05252fe09b213f98a7248575ed0caff0a3b7f3daef040faf89a88fdac01b7">apollo::client::ChangeType::Updated</a></div><div class="ttdeci">@ Updated</div><div class="ttdef"><b>Definition</b> apollo_types.h:31</div></div>
<div class="ttc" id="aapollo__types_8h_html_ad68bbd8ab75d3434eb689eec7620e616"><div class="ttname"><a href="apollo__types_8h.html#ad68bbd8ab75d3434eb689eec7620e616">apollo::client::Configures</a></div><div class="ttdeci">std::map&lt; std::string, std::string &gt; Configures</div><div class="ttdoc">Map of key-value pairs representing a namespace&#39;s configuration.</div><div class="ttdef"><b>Definition</b> apollo_types.h:65</div></div>
<div class="ttc" id="astructapollo_1_1client_1_1_opts_html"><div class="ttname"><a href="structapollo_1_1client_1_1_opts.html">apollo::client::Opts</a></div><div class="ttdoc">Options for configuring the Apollo client.</div><div class="ttdef"><b>Definition</b> apollo_types.h:73</div></div>
<div class="ttc" id="astructapollo_1_1client_1_1_opts_html_a488e477e0eb10f69f67651f46c59fd16"><div class="ttname"><a href="structapollo_1_1client_1_1_opts.html#a488e477e0eb10f69f67651f46c59fd16">apollo::client::Opts::namespaces_</a></div><div class="ttdeci">std::vector&lt; NamespaceType &gt; namespaces_</div><div class="ttdef"><b>Definition</b> apollo_types.h:76</div></div>
<div class="ttc" id="astructapollo_1_1client_1_1_opts_html_ab66463ed5bce41fd676467ec00289eaf"><div class="ttname"><a href="structapollo_1_1client_1_1_opts.html#ab66463ed5bce41fd676467ec00289eaf">apollo::client::Opts::cluster_name_</a></div><div class="ttdeci">std::string cluster_name_</div><div class="ttdef"><b>Definition</b> apollo_types.h:74</div></div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
💡 Tips</h1>
<ul>
<li>boost usage provides detailed instructions on how to use Boost libraries with this project.</li>
<li>nlohmann_json provides detailed instructions on how to use nlohmann_json with this project.</li>
<li>doctest usage provides detailed instructions on how to use doctest for unit testing in this project. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
